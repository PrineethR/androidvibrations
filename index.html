<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vibe DAW (Video + Haptics)</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 1100px; margin: 16px auto; padding: 0 12px; }
    .grid { display: grid; grid-template-columns: 1fr; gap: 12px; }
    video { width: 100%; background:#111; border-radius: 10px; max-height: 55vh; }
    .panel { border: 1px solid #ddd; border-radius: 10px; padding: 12px; }
    .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    button { padding: 8px 10px; }
    input[type="text"] { padding: 8px; width: min(540px, 100%); }
    canvas { width: 100%; height: 160px; background: #0f1220; border-radius: 10px; touch-action: none; }
    .small { font-size: 12px; color: #444; }
    pre { background:#f5f5f5; border-radius: 8px; padding: 10px; overflow:auto; }
    label { display:flex; gap:6px; align-items:center; }
  </style>
</head>
<body>
  <h1>Vibe DAW</h1>

  <div class="grid">
    <div class="panel">
      <div class="row">
        <input id="videoFile" type="file" accept="video/*" />
        <button id="armBtn">Enable vibration</button>
        <button id="playBtn">Play/Pause</button>
        <button id="stopVibeBtn">Stop vibration</button>
        <span id="support" class="small"></span>
      </div>

      <video id="video" playsinline></video>

      <div class="small" style="margin-top:6px;">
        Video time: <span id="tNow">0.000</span>s / <span id="tDur">0.000</span>s
      </div>
    </div>

    <div class="panel">
      <h2>Timeline</h2>
      <div class="row">
        <label><input id="snap" type="checkbox" checked /> Snap 0.1s</label>
        <button id="zoomIn">Zoom +</button>
        <button id="zoomOut">Zoom âˆ’</button>
        <button id="clearAll">Clear</button>
      </div>

      <canvas id="tl" width="1200" height="160"></canvas>
      <div class="small">
        Tap/click empty space to create a clip at that time. Drag clip to move. Drag right edge to resize. Press Delete to remove selected.
      </div>

      <h2 style="margin-top:12px;">Clip pattern</h2>
      <div class="row">
        <input id="pattern" type="text" placeholder="250, 100, 250, 100, 400 (or JSON array)" />
        <button id="applyPattern">Apply to selected</button>
        <button id="previewPattern">Preview selected</button>
      </div>
      <div class="small">Patterns are passed to <code>navigator.vibrate([...])</code> in ms. [web:1]</div>

      <h2 style="margin-top:12px;">Export</h2>
      <div class="row">
        <button id="exportJson">Export JSON</button>
        <button id="exportVibrate">Export navigator.vibrate([...])</button>
      </div>
      <pre id="out"></pre>
    </div>
  </div>

  <script src="daw.js"></script>
</body>
</html>
